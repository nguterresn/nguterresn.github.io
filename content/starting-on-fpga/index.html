<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
    />
    
      <meta name="description" content="A place where I write about what I'm doing during the weekend." />
    
    
      <meta name="author" content="Nuno Nogueira" />
    

    <meta property="twitter:card" content="summary">
    <meta property="twitter:url" content="https://guterresnogueira.com/content/starting-on-fpga/">
    <meta property="twitter:title" content="Starting on FPGA...">
    <meta property="twitter:image" content="../../favicon/android-chrome-192x192.png">

    <link rel="apple-touch-icon" sizes="180x180" href="../../favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../favicon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../favicon/favicon-32x32.png">

    <title>
      Starting on FPGA... - Nuno Nogueira
    </title>

    <!-- Bulma CSS framework -->
    <!-- <link href="../../bulma.min.css" rel="stylesheet" /> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">

    <!-- Custom styles for this template -->
    <link href="../../style.css" rel="stylesheet" />
    <link href="../../code_theme.css" rel="stylesheet" />

    <!-- Script to support LaTex -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
    <!-- Import custom script -->
    <!-- Custom code, enable support for inline LaTex equations -->
    <script type="text/javascript" src="../../script.js" defer></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-G15FQ3N6VZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-G15FQ3N6VZ');
    </script>
  </head>
  <body>
    <header>
      <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="container is-max-desktop">
          <div class="navbar-brand">
            <a class="navbar-item" href="../..">
              Nuno Guterres Nogueira
            </a>
            <a
              role="button"
              class="navbar-burger"
              aria-label="menu"
              aria-expanded="false"
              data-target="navbar_menu"
            >
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
            </a>
          </div>

          <div class="navbar-menu" id="navbar_menu">
            <div class="navbar-end">
               
              <a
                class="navbar-item"
                href="../.."
              >
                Home
              </a>
              
              <a
                class="navbar-item"
                href="https://m.me/nunoguterresn"
              >
                Contact me
              </a>
               
            </div>
          </div>
        </div>
      </nav>
    </header>

    <section class="section">
      <div class="container is-max-desktop">
        <article class="content"><h1 id="starting-on-fpga">Starting on FPGA...</h1>
<p>I'm now starting dealing with FPGA on my daily basis, so I thought it would be the perfect time to keep my journey with this technology all documented.</p>
<p>Since I'm using a <a href="https://www.digikey.pt/product-detail/en/terasic-inc/P0150/P0150-ND/4437934?utm_adgroup=Evaluation+Boards+-+Embedded+-+Complex+Logic+%28FPGA%2C+CPLD%29&amp;mkwid=s0lPRfTCq&amp;pcrid=294914797630&amp;pkw=&amp;pmt=&amp;pdv=c&amp;productid=4437934&amp;slid=&amp;gclid=Cj0KCQiAq97uBRCwARIsADTziyZ1LkkBkoJ1T5qDP-c0lC52miFpQGj6UNMtO8Wr7fuIuYmuFlnZ3VQaAjaJEALw_wcB">Cyclone V GX</a>, I use the Quartus II Lite software (20.1v) from Intel to design and program the FPGA. From my MacOS device, I'm running a virtual machine (Parallels 13) with <a href="https://lubuntu.net">Lubuntu</a> 16.04 LTS 64-bit installed. For FPGA development it's advisable to <a href="https://www.reddit.com/r/FPGA/comments/6md9el/computer_specs_for_fpga_development/">have high speed CPU with multiple cores and fast RAM</a>, therefore I didn't want to use a lot of RAM and CPU power - I choose Lubuntu for being well known for its low-power needs and still providing a reliable OS, trying to make the best of the situation, since running a OS above other OS is not the ideal scenery.</p>
<p>Although, in Linux, there is no need to install any driver to the USB Blaster, it's necessary to set the permissions related to the usb serial port. Intel has its own documentation about this, but I found <a href="https://github.com/vidor-libraries/USBBlaster#linux">a better a smaller one which provides solutions for any problem about the USB Blaster</a> (I had the stated <code>jtagd</code> problem and fixed it by closing the Quartus, kill any <code>jtagd</code> process and open it again).</p>
<p>During my research to setup the FPGA development software, I came up with a ton of useful and very important tutorials from Intel explaining how to program the FPGA and tutorials about HDL basic design:</p>
<ul>
<li><a href="https://software.intel.com/content/www/us/en/develop/articles/how-to-program-your-first-fpga-device.html">How to Program Your First FPGA Device</a></li>
<li><a href="https://www.youtube.com/watch?v=bwoyQ_RnaiA">How to Begin a Simple FPGA Design</a></li>
<li><a href="https://www.youtube.com/watch?v=PJGvZSlsLKs">Verilog HDL Basics</a></li>
</ul>
<p>Also, some useful additional links:</p>
<ul>
<li><a href="https://www.ece.ucdavis.edu/~bbaas/180/tutorials/file.organization.html">EEC 180 Tutorial: (Strongly) Recommended File Organization</a></li>
<li><a href="http://www.asic-world.com/verilog/veritut.html">Verilog Tutorial</a></li>
</ul>
<hr />
<h3 id="pin-planner-and-first-modules">Pin Planner and First Modules</h3>
<p>As I finished the tutorials I started playing around with the FPGA, trying to create some logic design and program it to the FPGA. From the <a href="https://software.intel.com/content/www/us/en/develop/articles/how-to-program-your-first-fpga-device.html">How to Program Your First FPGA Device</a> I copied the template and made this simple blink code that uses a 32-bit counter, a switch and 2 Leds:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// create module</span>
<span class="k">module</span> <span class="n">blink</span> <span class="p">(</span>
    <span class="k">input</span> <span class="kt">wire</span> <span class="n">clk</span><span class="p">,</span> <span class="c1">// 50MHz input clock</span>
    <span class="k">input</span> <span class="kt">wire</span> <span class="n">switch</span><span class="p">,</span>
    <span class="k">output</span> <span class="kt">wire</span> <span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">LED</span> <span class="c1">// LED ouput</span>
<span class="p">);</span>

<span class="c1">// create a binary counter</span>
<span class="kt">reg</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">cnt</span><span class="p">;</span> <span class="c1">// 32-bit counter</span>

<span class="k">initial</span> <span class="k">begin</span>
  <span class="n">cnt</span> <span class="o">&lt;=</span> <span class="mh">32&#39;h00000000</span><span class="p">;</span> <span class="c1">// start at zero</span>
<span class="k">end</span>

<span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
    <span class="n">cnt</span> <span class="o">&lt;=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mh">1</span><span class="p">;</span> <span class="c1">// count up</span>
<span class="k">end</span>

<span class="c1">//assign LED to 25th bit of the counter to blink the LED at a few Hz</span>
<span class="k">assign</span> <span class="n">LED</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">switch</span> <span class="o">?</span> <span class="n">cnt</span><span class="p">[</span><span class="mh">25</span><span class="p">]</span> <span class="o">:</span> <span class="n">cnt</span><span class="p">[</span><span class="mh">22</span><span class="p">];</span>
<span class="k">assign</span> <span class="n">LED</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">switch</span> <span class="o">?</span> <span class="n">cnt</span><span class="p">[</span><span class="mh">22</span><span class="p">]</span> <span class="o">:</span> <span class="n">cnt</span><span class="p">[</span><span class="mh">25</span><span class="p">];</span>

<span class="k">endmodule</span>
</code></pre></div>
<p>Then, after creating this simple module I connected the I/O to actual PINs in the development board.</p>
<p><img alt="Copy%20of%20Starting%20on%20FPGA%20be15147673c6465a831d47727f8baf1c/Captura_de_ecra_2020-09-19_as_19.05.49.png" src="../img/Captura_de_ecra_2020-09-19_as_19.05.49.png" /></p>
<p>To the <code>switch</code> I choose the first one, Slide switch[0], <strong>PIN_AC9.</strong></p>
<p><img alt="Copy%20of%20Starting%20on%20FPGA%20be15147673c6465a831d47727f8baf1c/Captura_de_ecra_2020-09-19_as_19.07.02.png" src="../img/Captura_de_ecra_2020-09-19_as_19.07.02.png" /></p>
<p>To the <code>LED[0]</code>, set the first red LED, <strong>PIN_F7</strong>.</p>
<p>To the <code>LED[1]</code>, set the first green LED, <strong>PIN_L7.</strong></p>
<p><img alt="Copy%20of%20Starting%20on%20FPGA%20be15147673c6465a831d47727f8baf1c/Captura_de_ecra_2020-09-19_as_19.10.17.png" src="../img/Captura_de_ecra_2020-09-19_as_19.10.17.png" /></p>
<p>And finally, to the <code>clk</code> , set the <strong>PIN_R20</strong>.</p>
<p>Be careful setting the I/O standard voltage.</p>
<p>This is a very simple program but allows to check the peripherals inside the development board.</p>
<h3 id="current-situation">Current situation...</h3>
<p>I'm now trying to establish UART communication between the FPGA and the Computer. Along my search I came across with two possibilities:</p>
<ul>
<li>Creating a <a href="https://www.intel.com/content/www/us/en/programmable/support/training/course/oqsys1000.html">Qsys</a> with Nios 2 <a href="https://en.wikipedia.org/wiki/Soft_microprocessor">soft processor</a> and using C to bridge the communication</li>
</ul>
<p>Easier and provides C programming capabilities but Nios 2 is not open-source and the provided version of it for Lite License is very slow. Also takes FPGA capacity.</p>
<ul>
<li>Using custom Verilog modules to design UART to RS232 communication</li>
</ul>
<p>Not so easy to implement, requires deep learning of UART technology and Verilog. Relies only in HDL.</p>
<hr /></article>
        
          <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-via="nunoguterres" data-show-count="false">Tweet</a>
          <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

        
      </div>
    </section>

    <section class="hero is-link">
      <div class="hero-body">
        <p class="title">
          Follow me around the internet ⤵
        </p>
        <p class="subtitle">
          <div class="internet_links">
            <div class="icon">
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://www.instagram.com/nunognogueira/"
              >
                <img
                  src="../../icons/instagram.svg"
                  alt=""
                  width="30"
                  height="30"
                />
              </a>
            </div>
            <div class="icon">
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://twitter.com/nunoguterres"
              >
                <img
                  src="../../icons/twitter.svg"
                  alt=""
                  width="30"
                  height="30"
                />
              </a>
            </div>
            <div class="icon">
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://www.linkedin.com/in/guterresnogueira/"
              >
                <img
                  src="../../icons/linkedin.svg"
                  alt=""
                  width="30"
                  height="30"
                />
              </a>
            </div>
            <div class="icon">
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://github.com/nguterresn"
              >
                <img
                  src="../../icons/github.svg"
                  alt=""
                  width="30"
                  height="30"
                />
              </a>
            </div>
          </div>
        </p>
        <br>
        <p class="subtitle">
          <img src="../../icons/nuno.png" alt="" width="80" height="80">
        </p>
      </div>
    </section>
  </body>
</html>